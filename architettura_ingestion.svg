<svg width="1000" height="600" viewBox="0 0 1000 600" fill="none" xmlns="http://www.w3.org/2000/svg">
  <rect width="1000" height="600" rx="15" fill="#fcfdfe"/>
  <text x="500" y="40" font-family="Arial" font-size="22" font-weight="bold" fill="#1e293b" text-anchor="middle">FASE 1: CARICAMENTO DATI E INGESTION</text>

  <!-- Moduli -->
  <rect x="50" y="200" width="220" height="250" rx="10" fill="#f0fdf4" stroke="#10b981" stroke-width="2"/>
  <text x="160" y="230" font-family="Arial" font-size="16" font-weight="bold" fill="#064e3b" text-anchor="middle">STREAMLIT UI</text>
  <text x="160" y="255" font-family="Arial" font-size="11" fill="#059669" text-anchor="middle">(Interfaccia Upload)</text>

  <rect x="730" y="100" width="220" height="120" rx="10" fill="#f1f5f9" stroke="#334155" stroke-width="2"/>
  <text x="840" y="130" font-family="Arial" font-size="14" font-weight="bold" fill="#334155" text-anchor="middle">POSTGRESQL</text>
  
  <rect x="730" y="260" width="220" height="120" rx="10" fill="#fff7ed" stroke="#c2410c" stroke-width="2"/>
  <text x="840" y="290" font-family="Arial" font-size="14" font-weight="bold" fill="#c2410c" text-anchor="middle">QDRANT (Vector)</text>
  <text x="840" y="310" font-family="Arial" font-size="10" fill="#9a3412" text-anchor="middle">Modello: all-MiniLM-L6-v2</text>

  <rect x="730" y="420" width="220" height="120" rx="10" fill="#f8fafc" stroke="#64748b" stroke-width="2"/>
  <text x="840" y="450" font-family="Arial" font-size="14" font-weight="bold" fill="#475569" text-anchor="middle">FILE SYSTEM</text>

  <!-- Frecce Bidirezionali -->
  <!-- SQL -->
  <path d="M270 210 H730" stroke="#334155" stroke-width="1.5" marker-end="url(#arrow-black)"/>
  <text x="500" y="200" font-family="Courier New" font-size="11" fill="#334155" text-anchor="middle">cur.execute("INSERT INTO documents...")</text>
  <path d="M730 230 H270" stroke="#334155" stroke-width="1.5" stroke-dasharray="4" marker-end="url(#arrow-black)"/>
  <text x="500" y="245" font-family="Courier New" font-size="11" fill="#334155" text-anchor="middle">Successo / IntegrityError (Hash Check)</text>

  <!-- Vector -->
  <path d="M270 310 H730" stroke="#c2410c" stroke-width="1.5" marker-end="url(#arrow-orange)"/>
  <text x="500" y="300" font-family="Courier New" font-size="11" fill="#c2410c" text-anchor="middle">vector_store.add_documents(chunks)</text>
  <path d="M730 330 H270" stroke="#c2410c" stroke-width="1.5" stroke-dasharray="4" marker-end="url(#arrow-orange)"/>
  <text x="500" y="345" font-family="Courier New" font-size="11" fill="#c2410c" text-anchor="middle">Embedding &amp; Vector Indexing OK</text>

  <!-- FileSystem -->
  <path d="M270 410 H730" stroke="#64748b" stroke-width="1.5" marker-end="url(#arrow-gray)"/>
  <text x="500" y="400" font-family="Courier New" font-size="11" fill="#475569" text-anchor="middle">open(f_path, "wb").write()</text>
  <path d="M730 435 H270" stroke="#64748b" stroke-width="1.5" stroke-dasharray="4" marker-end="url(#arrow-gray)"/>
  <text x="500" y="450" font-family="Courier New" font-size="11" fill="#475569" text-anchor="middle">File salvato in /uploads</text>

  <!-- Logica Interna UI -->
  <rect x="60" y="470" width="200" height="80" rx="5" fill="white" stroke="#10b981" stroke-dasharray="2"/>
  <text x="160" y="495" font-family="Arial" font-size="10" fill="#065f46" text-anchor="middle">hashlib.md5(content)</text>
  <text x="160" y="515" font-family="Arial" font-size="10" fill="#065f46" text-anchor="middle">PdfReader.extract_text()</text>
  <text x="160" y="535" font-family="Arial" font-size="10" fill="#065f46" text-anchor="middle">RecursiveCharacterTextSplitter()</text>

  <defs>
    <marker id="arrow-black" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#334155"/></marker>
    <marker id="arrow-orange" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#c2410c"/></marker>
    <marker id="arrow-gray" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#64748b"/></marker>
  </defs>
</svg>
